(function(e){function t(t){for(var n,s,i=t[0],c=t[1],l=t[2],h=0,d=[];h<i.length;h++)s=i[h],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&d.push(r[s][0]),r[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,i=1;i<o.length;i++){var c=o[i];0!==r[c]&&(n=!1)}n&&(a.splice(t--,1),e=s(s.s=o[0]))}return e}var n={},r={app:0},a=[];function s(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=n,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(o,n,function(t){return e[t]}.bind(null,n));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;a.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("cd49")},"6c4e":function(e,t,o){"use strict";o("b98d")},"8f7d":function(e,t,o){},a347:function(e,t,o){},b98d:function(e,t,o){},cd49:function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n,r=o("2b0e"),a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"},on:{mousemove:e.updateMousePos}},[e.showingSizeIndicator?o("div",{style:e.sizeIndicatorStyles,attrs:{id:"tool-size-indicator"}}):e._e(),o("main",[o("div",{staticClass:"sidebar left"},[o("h2",[e._v("Tools")]),o("div",{attrs:{id:"tools"}},e._l(e.$store.tools,(function(t,n){return o("button",{key:n,class:{selectedTool:n==e.$store.currentToolIdx},on:{click:function(t){return e.changeTool(n)}}},[e._v(" "+e._s(t.name)+" ")])})),0),o("h2",[e._v("Options")]),o("div",{attrs:{id:"tool-options"}},e._l(e.$store.currentTool.options,(function(t,n){return o("div",{key:n,staticStyle:{"text-align":"left"}},[o("label",[e._v(e._s(e.startCase(n)))]),"boolean"!=t.type?o("br"):e._e(),"number"==t.type?o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.value,expression:"option.value",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.value},on:{input:function(o){o.target.composing||e.$set(t,"value",e._n(o.target.value))},blur:function(t){return e.$forceUpdate()}}}):"color"==t.type?o("chrome-picker",{staticClass:"color-picker",attrs:{value:t.value},on:{input:function(e){return t.value=e.hex8}}}):"boolean"==t.type?o("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"option.value"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.value)?e._i(t.value,null)>-1:t.value},on:{change:function(o){var n=t.value,r=o.target,a=!!r.checked;if(Array.isArray(n)){var s=null,i=e._i(n,s);r.checked?i<0&&e.$set(t,"value",n.concat([s])):i>-1&&e.$set(t,"value",n.slice(0,i).concat(n.slice(i+1)))}else e.$set(t,"value",a)}}}):e._e()],1)})),0)]),o("div",[o("Canvas",{on:{mouseover:function(t){e.$store.hoveringCanvas=!0},mouseleave:function(t){e.$store.hoveringCanvas=!1}}})],1),o("div",{staticClass:"sidebar right"},[o("h2",[e._v("Layers")]),o("draggable",{attrs:{animation:200},model:{value:e.$store.layers,callback:function(t){e.$set(e.$store,"layers",t)},expression:"$store.layers"}},[o("transition-group",{attrs:{type:"transition"}},e._l(e.$store.layers,(function(t){return o("div",{key:t.id,staticClass:"layer",class:{selectedLayer:t.id==e.$store.currentLayerId},on:{click:function(o){return e.clickedLayer(t.id)}}},[e._v(" "+e._s(t.name)+" ")])})),0)],1),o("div",{staticClass:"center-child"},[o("button",{on:{click:e.addLayer}},[e._v("Add Layer")])]),o("p",[e._v(e._s(e.$store.currentPrefixedShortcutKey))]),o("h2",[e._v("Actions")]),o("button",{on:{click:e.clearLayer}},[e._v("Clear Layer")]),o("button",{on:{click:e.saveCanvas}},[e._v("Save as Image")]),o("button",{on:{click:e.undo}},[e._v("Undo")]),o("button",{on:{click:e.redo}},[e._v("Redo")])],1)])])},s=[],i=o("d4ec"),c=o("bee2"),l=o("262e"),u=o("2caf"),h=o("9ab4"),d=o("1b40"),p=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"canvas"},on:{mouseover:function(t){return e.$emit("mouseover")},mouseleave:function(t){return e.$emit("mouseleave")}}})},v=[],f=o("b85c"),y=o("3425"),g=o.n(y);o("cb29"),o("b0c0");(function(e){e["Pen"]="Pen",e["Eraser"]="Eraser",e["Rect"]="Rect",e["Ellipse"]="Ellipse"})(n||(n={}));var b=function e(){Object(i["a"])(this,e)},k=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(e,r){var a;return Object(i["a"])(this,o),a=t.call(this),a.type=n.Pen,a.name="Pen",a.options={size:{type:"number",value:null!==e&&void 0!==e?e:3},color:{type:"color",value:null!==r&&void 0!==r?r:"white"}},a}return o}(b),m=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(e){var r;return Object(i["a"])(this,o),r=t.call(this),r.type=n.Eraser,r.name="Eraser",r.options={size:{type:"number",value:null!==e&&void 0!==e?e:10}},r}return o}(b),$=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(e,r,a,s,c,l){var u;return Object(i["a"])(this,o),u=t.call(this),u.type=n.Rect,u.name="Rect",u.options={stroke:{type:"boolean",value:null===e||void 0===e||e},strokeWeight:{type:"number",value:null!==r&&void 0!==r?r:3},strokeColor:{type:"color",value:null!==a&&void 0!==a?a:"white"},fill:{type:"boolean",value:null!==s&&void 0!==s&&s},fillColor:{type:"color",value:null!==c&&void 0!==c?c:"white"},cornerRadius:{type:"number",value:null!==l&&void 0!==l?l:0}},u}return o}(b),S=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(e,r,a,s,c){var l;return Object(i["a"])(this,o),l=t.call(this),l.type=n.Ellipse,l.name="Ellipse",l.options={stroke:{type:"boolean",value:null===e||void 0===e||e},strokeWeight:{type:"number",value:null!==r&&void 0!==r?r:3},strokeColor:{type:"color",value:null!==a&&void 0!==a?a:"white"},fill:{type:"boolean",value:null!==s&&void 0!==s&&s},fillColor:{type:"color",value:null!==c&&void 0!==c?c:"white"}},l}return o}(b),x=function e(){Object(i["a"])(this,e)},O=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(e,n,r){var a;return Object(i["a"])(this,o),a=t.call(this),a.points=e,a.tool=n,a.options=r,a}return o}(x),j=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(e,n,r,a){var s;return Object(i["a"])(this,o),s=t.call(this),s.topLeft=e,s.bottomRight=n,s.tool=r,s.options=a,s}return o}(x),w="black",I=o("0644"),C=o.n(I),_=o("11c1"),L=function(){function e(t,o){Object(i["a"])(this,e),this.graphics=t.createGraphics(t.width,t.height),this.width=t.width,this.height=t.height,this.name=o,this.id=Object(_["v4"])(),this.shapes=[],this.currentShapeIdx=null}return Object(c["a"])(e,[{key:"update",value:function(e){this.graphics.clear();var t,o=Object(f["a"])(this.shapes);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(this.graphics.push(),r instanceof O){var a;this.graphics.noFill(),this.graphics.stroke(r.tool==n.Pen&&"color"in r.options?r.options.color.value:null!==(a=e.backgroundColor)&&void 0!==a?a:w),this.graphics.beginShape(),this.graphics.strokeWeight(r.options.size.value);var s,i=Object(f["a"])(r.points);try{for(i.s();!(s=i.n()).done;){var c=s.value;this.graphics.vertex(c.x,c.y)}}catch(h){i.e(h)}finally{i.f()}this.graphics.endShape()}else if(r instanceof j){var l,u;if(r.options.fill.value?this.graphics.fill(r.options.fillColor.value):this.graphics.noFill(),r.options.stroke.value?this.graphics.stroke(r.options.strokeColor.value):this.graphics.noStroke(),this.graphics.strokeWeight(r.options.strokeWeight.value),r.tool==n.Rect)this.graphics.rectMode(this.graphics.CORNERS),this.graphics.rect(r.topLeft.x,r.topLeft.y,r.bottomRight.x,r.bottomRight.y,null!==(l=null===(u=r.options.cornerRadius)||void 0===u?void 0:u.value)&&void 0!==l?l:0);else r.tool==n.Ellipse&&(this.graphics.ellipseMode(this.graphics.CORNERS),this.graphics.ellipse(r.topLeft.x,r.topLeft.y,r.bottomRight.x,r.bottomRight.y))}this.graphics.pop()}}catch(h){o.e(h)}finally{o.f()}}},{key:"mouseDragged",value:function(e,t){var o=e.createVector(e.mouseX,e.mouseY);t instanceof k||t instanceof m?null==this.currentShapeIdx?(this.currentShapeIdx=this.shapes.length,this.shapes.push(new O([o],t.type,C()(t.options)))):this.currentShape instanceof O&&this.currentShape.points.push(o):(t instanceof $||t instanceof S)&&(null==this.currentShapeIdx?(this.currentShapeIdx=this.shapes.length,this.shapes.push(new j(o,o,t.type,C()(t.options)))):this.currentShape instanceof j&&(this.currentShape.bottomRight=o))}},{key:"mouseReleased",value:function(){this.currentShapeIdx=null}},{key:"clear",value:function(){this.shapes=[],this.currentShapeIdx=null}},{key:"currentShape",get:function(){return null==this.currentShapeIdx?null:this.shapes[this.currentShapeIdx]}}]),e}(),P={createLayer:"createLayer",saveCanvas:"saveCanvas",undo:"undo",redo:"redo"},T=P;function R(e,t){return Object.hasOwnProperty.call(e,t)}var U=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(){return Object(i["a"])(this,o),t.apply(this,arguments)}return Object(c["a"])(o,[{key:"mounted",value:function(){var e=this,t=function(t){var o;e.$root.$on(T.createLayer,(function(){e.$store.layers.push(new L(t,"Layer ".concat(e.$store.layers.length+1))),e.$store.currentLayerId=e.$store.layers[e.$store.layers.length-1].id})),e.$root.$on(T.saveCanvas,(function(){if(null==o)alert("Sorry, the canvas hasn't loaded yet");else{var e,n=null===(e=prompt("File format (png|jpg)","png"))||void 0===e?void 0:e.toLowerCase();if(!n)return;"png"!=n&&"jpg"!=n?alert("Invalid format, can only be 'png' or 'jpg'"):t.save(o,"sketch.".concat(n))}})),e.$root.$on(T.undo,(function(){console.log("undo event received"),e.$store.undo()})),e.$root.$on(T.redo,(function(){console.log("redo event received"),e.$store.redo()})),t.setup=function(){o=t.createCanvas(.5*window.innerWidth,window.innerHeight),e.$store.layers=[new L(t,"Layer 1")],e.$store.currentLayerId=e.$store.layers[0].id,e.$store.pushUndoState(),console.log(e.$store)},t.draw=function(){var o;t.background(null!==(o=e.$store.backgroundColor)&&void 0!==o?o:t.color(0));var n,r=Object(f["a"])(e.$store.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.update(e.$store)}}catch(l){r.e(l)}finally{r.f()}var s,i=Object(f["a"])(e.$store.layers);try{for(i.s();!(s=i.n()).done;){var c=s.value;t.image(c.graphics,0,0)}}catch(l){i.e(l)}finally{i.f()}},t.mouseDragged=function(){var o;e.$store.hoveringCanvas&&(console.log("mouse dragged"),null===(o=e.$store.currentLayer)||void 0===o||o.mouseDragged(t,e.$store.currentTool))},t.mouseReleased=function(){var t;e.$store.hoveringCanvas&&(null===(t=e.$store.currentLayer)||void 0===t||t.mouseReleased(),e.$store.pushUndoState())},t.keyPressed=function(){var o=function(t){if(e.$store.currentPrefixedShortcutKey==e.$config.changeColorShortcutPrefix){if(R(e.$store.currentTool.options,"color")){var o=e.$config.changeColorShortcutMap[t];o?(console.log("Changing color to ".concat(o,"...")),e.$store.currentTool.options.color.value=o):console.log("Invalid color: ".concat(t))}e.$store.currentPrefixedShortcutKey=null}};switch(t.key){case"b":o("b");break;case"c":e.$store.currentPrefixedShortcutKey="c",setTimeout((function(){e.$store.currentPrefixedShortcutKey=null}),1e3);break;case"e":console.log("E key pressed"),e.$store.setCurrentTool(n.Eraser);break;case"p":e.$store.setCurrentTool(n.Pen);break;case"w":o("w");break;default:o(t.key);break}}};new g.a(t,document.getElementById("canvas"))}}]),o}(d["b"]);U=Object(h["a"])([d["a"]],U);var E=U,z=E,M=(o("6c4e"),o("2877")),K=Object(M["a"])(z,p,v,!1,null,"4c604da2",null),W=K.exports,A=o("b76a"),B=o.n(A),D=o("c345"),N=function(e){Object(l["a"])(o,e);var t=Object(u["a"])(o);function o(){return Object(i["a"])(this,o),t.apply(this,arguments)}return Object(c["a"])(o,[{key:"updateMousePos",value:function(e){this.$store.mousePos.x=e.pageX,this.$store.mousePos.y=e.pageY}},{key:"addLayer",value:function(){this.$root.$emit(T.createLayer)}},{key:"changeTool",value:function(e){this.$store.currentToolIdx=e}},{key:"clearLayer",value:function(){this.$store.currentLayer.clear()}},{key:"updateOption",value:function(e){console.log(e)}},{key:"clickedLayer",value:function(e){this.$store.currentLayerId=e}},{key:"saveCanvas",value:function(){this.$root.$emit(T.saveCanvas)}},{key:"undo",value:function(){console.log("undo button pressed"),this.$root.$emit(T.undo)}},{key:"redo",value:function(){console.log("redo button pressed"),this.$root.$emit(T.redo)}},{key:"sizeIndicatorStyles",get:function(){var e=3;return this.$store.currentTool instanceof k||this.$store.currentTool instanceof m?e=this.$store.currentTool.options.size.value:this.$store.currentTool instanceof $&&(e=this.$store.currentTool.options.stroke?this.$store.currentTool.options.strokeWeight.value:e),e<1&&(e=1),{width:e+"px",height:e+"px",top:this.$store.mousePos.y-e/2+"px",left:this.$store.mousePos.x-e/2+"px"}}},{key:"showingSizeIndicator",get:function(){return this.$store.hoveringCanvas}}]),o}(d["b"]);N=Object(h["a"])([Object(d["a"])({components:{Canvas:W,draggable:B.a,"chrome-picker":D["Chrome"]}})],N);var F=N,X=F,J=(o("ff49"),Object(M["a"])(X,a,s,!1,null,"a8ab6c54",null)),Y=J.exports,G=(o("99af"),o("4de4"),o("c740"),o("fb6a"),function(){function e(){Object(i["a"])(this,e),this.layers=[],this.currentLayerId=null,this.tools=[new k,new m,new $,new S],this.currentToolIdx=0,this.backgroundColor="black",this.currentPrefixedShortcutKey=null,this.hoveringCanvas=!1,this.mousePos={x:0,y:0},this.undoStack=[],this.undoStackIdx=0}return Object(c["a"])(e,[{key:"currentTool",get:function(){return this.tools[this.currentToolIdx]}},{key:"setCurrentTool",value:function(e){this.currentToolIdx=this.tools.findIndex((function(t){return t.type==e}))}},{key:"currentLayer",get:function(){var e=this;return this.layers.filter((function(t){return t.id==e.currentLayerId}))[0]}},{key:"pushUndoState",value:function(){var e;console.log("pushing new undo state..."),console.log("Undo stack length: ".concat(this.undoStack.length,", Undo index: ").concat(this.undoStackIdx)),this.undoStackIdx<this.undoStack.length-1&&(console.log("rewriting history..."),this.undoStack=C()(this.undoStack).slice(0,this.undoStackIdx+1),this.undoStackIdx=this.undoStack.length-1),console.log("Undo stack length: ".concat(this.undoStack.length,", Undo index: ").concat(this.undoStackIdx)),this.undoStackIdx=this.undoStack.length,this.undoStack.push(C()({layerId:null!==(e=this.currentLayerId)&&void 0!==e?e:"",layers:this.layers})),console.log("Undo stack length: ".concat(this.undoStack.length,", Undo index: ").concat(this.undoStackIdx))}},{key:"undo",value:function(){console.log("Undo stack length: ".concat(this.undoStack.length,", Undo index: ").concat(this.undoStackIdx)),this.undoStackIdx<=0||this.undoStack.length<=1||(this.undoStackIdx--,this.updateStateBasedOnUndoStack(),console.log("Undo stack length: ".concat(this.undoStack.length,", Undo index: ").concat(this.undoStackIdx)))}},{key:"redo",value:function(){console.log("Redoing..."),this.undoStack.length<=1||this.undoStackIdx>=this.undoStack.length-1||(this.undoStackIdx++,this.updateStateBasedOnUndoStack())}},{key:"updateStateBasedOnUndoStack",value:function(){this.layers=C()(this.undoStack[this.undoStackIdx].layers),this.currentLayerId=C()(this.undoStack[this.undoStackIdx].layerId)}}]),e}()),H=(o("a347"),function e(){Object(i["a"])(this,e),this.changeColorShortcutPrefix="c",this.prefixShortcutDuration=1e3,this.changeColorShortcutMap={b:"blue",w:"white",g:"green",r:"red",y:"yellow",B:"black"}}),V=o("e740"),q=o.n(V),Q=o("faac"),Z=o.n(Q);r["a"].config.productionTip=!1,r["a"].prototype.$store=r["a"].observable(new G),r["a"].prototype.$config=r["a"].observable(new H),r["a"].mixin({methods:{startCase:q.a}});var ee=new r["a"]({render:function(e){return e(Y)}}).$mount("#app");window.onkeydown=function(e){var t,o="OS X"==(null===(t=Z.a.os)||void 0===t?void 0:t.family)?e.metaKey:e.ctrlKey;o&&e.shiftKey&&"z"==e.key?(console.log("command/ctrl shift z pressed"),ee.$emit(T.redo)):o&&"z"==e.key&&(console.log("command/ctrl z pressed"),ee.$emit(T.undo))}},ff49:function(e,t,o){"use strict";o("8f7d")}});
//# sourceMappingURL=app.89fae8f1.js.map